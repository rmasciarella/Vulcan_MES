# Direnv configuration for Vulcan monorepo
# Safely load environment variables for local development
# Docs: https://direnv.net/

# Add local node binaries to PATH (pnpm, next, etc.)
PATH_add node_modules/.bin

# Load dotenv files if present
# Primary project vars
dotenv_if_exists .env
# Personal overrides (git-ignored recommended)
dotenv_if_exists .env.local

# Support a local shell-based override file (Bash syntax with export VAR=...)
source_env_if_exists .envrc.local

# Helpful defaults for local dev (non-secret)
export NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://localhost:8000}
export BACKEND_CORS_ORIGINS=${BACKEND_CORS_ORIGINS:-["http://localhost:3000"]}

# Supabase (safe defaults for local dev; override in .env or .envrc.local)
# Support both old (anon/service) and new (publishable/secret) naming from the dashboard.
# Frontend
export NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL:-${SUPABASE_URL}}
# Ensure both names are available in the environment
export NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=${NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY:-${NEXT_PUBLIC_SUPABASE_ANON_KEY:-${SUPABASE_ANON_KEY}}}
export NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY:-${NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY:-${SUPABASE_ANON_KEY}}}

# Server-side (never commit secrets)
export SUPABASE_URL=${SUPABASE_URL:-}
# Map new SUPABASE_SECRET to legacy SUPABASE_SERVICE_KEY if set
export SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY:-${SUPABASE_SECRET:-}}
# Keep anon available server-side if you choose to use it
export SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY:-}

# Hint: After editing this file, run `direnv allow .` to apply changes.
